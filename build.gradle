/*
 * This file was generated by the Gradle 'init' task.
 *
 * This project uses @Incubating APIs which are subject to change.
 */

plugins {
    id 'java'
    id 'maven-publish'
}

repositories {
    mavenLocal()
    mavenCentral {
        url = uri('https://repo.maven.apache.org/maven2/')
    }
}
dependencies {
    implementation 'com.fasterxml.jackson.core:jackson-core:2.19.0'
    implementation 'com.fasterxml.jackson.core:jackson-databind:2.19.0'
    implementation 'org.apache.commons:commons-lang3:3.17.0'
    implementation 'org.jetbrains:annotations:26.0.2'
}

group = 'com.npspot'
description = 'Nord Pool Intraday Public API classes'

if (System.getenv("VERSION")) {
    version = System.getenv("VERSION")
} else {
    version = '1.1.27'
}

java.sourceCompatibility = JavaVersion.VERSION_23
tasks.register('sourceJar', Jar) {
    from sourceSets.main.allSource
    archiveClassifier.set('sources')
}
publishing {
    publications {
        esamLibrary(MavenPublication){
            from(components.java)
            artifact tasks.named("sourceJar").get() // This line is added to include source code in the publication
        }
    }
    repositories {
        maven {
            name = "EsamS3MavenRepo"
            authentication {
                awsIm(AwsImAuthentication)  // takes the credentials from the ~/.aws/credentials
            }
            if (project.version.endsWith('-SNAPSHOT')) {
                url "s3://esamtrade-maven-repo/snapshots"
            } else {
                url "s3://esamtrade-maven-repo/releases"
            }
        }
    }
}